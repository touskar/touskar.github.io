(function(){var e={1508:function(e,t,a){"use strict";var n=a(3862),i=a(3396),r=a(7139);const s={id:"nav"},o=(0,i._)("span",{style:{display:"inline-block",width:"5px"}},null,-1),l={id:"app"};function c(e,t,a,n,c,u){const d=(0,i.up)("va-button"),h=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",s,[(0,i.Wm)(d,{color:"primary",onClick:t[0]||(t[0]=e=>u.goto("/")),style:{width:"140px"}},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)("Rechercher".toUpperCase()),1)])),_:1}),o,(0,i.Wm)(d,{color:"primary",onClick:t[1]||(t[1]=e=>u.goto("/train")),style:{width:"140px"}},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)("Entraîner".toUpperCase()),1)])),_:1})]),(0,i._)("div",l,[(0,i.Wm)(h)])],64)}var u={name:"App",methods:{goto(e){this.$router.push(e)}}},d=a(89);const h=(0,d.Z)(u,[["render",c]]);var p=h,f=a(678),m=a.p+"img/logo.10dda793.png";const g=(0,i._)("img",{style:{width:"100px"},src:m},null,-1);function v(e,t,a,n,r,s){const o=(0,i.up)("SearchAttachmentComponent");return(0,i.wg)(),(0,i.iD)(i.HY,null,[g,(0,i.Wm)(o)],64)}const w=e=>((0,i.dD)("data-v-5ae4a997"),e=e(),(0,i.Cn)(),e),y={class:"container"},x=w((()=>(0,i._)("div",{class:"hello"},"BioMetrex",-1))),b={style:{margin:"10px",_background:"#f9f9f9"},class:"dropzone-container"},_={key:0,style:{margin:"50px"}},k={class:"components"},C=w((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),O={class:"component",style:{}},F=w((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),j={class:"component",style:{}},P=w((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),S={class:"component",style:{}},T=w((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),U={key:1,style:{margin:"50px"}},M={class:"components"},W={key:2,style:{margin:"50px"}},B=["src"],D={accept:"image/png, image/jpeg",style:{display:"none"},ref:"input",type:"file"},V={class:"file-selector"},z=["src"],A={key:1,width:"104px",height:"104px",viewBox:"0 0 104 104",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},q=(0,i.uE)('<defs data-v-5ae4a997><circle id="path-1" cx="36" cy="36" r="36" data-v-5ae4a997></circle><filter x="-37.5%" y="-29.2%" width="175.0%" height="175.0%" filterUnits="objectBoundingBox" id="filter-2" data-v-5ae4a997><feOffset dx="0" dy="6" in="SourceAlpha" result="shadowOffsetOuter1" data-v-5ae4a997></feOffset><feGaussianBlur stdDeviation="8" in="shadowOffsetOuter1" result="shadowBlurOuter1" data-v-5ae4a997></feGaussianBlur><feColorMatrix values="0 0 0 0 0.0117647059   0 0 0 0 0.0862745098   0 0 0 0 0.160784314  0 0 0 0.08 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1" data-v-5ae4a997></feColorMatrix><feOffset dx="0" dy="1" in="SourceAlpha" result="shadowOffsetOuter2" data-v-5ae4a997></feOffset><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter2" result="shadowBlurOuter2" data-v-5ae4a997></feGaussianBlur><feColorMatrix values="0 0 0 0 0.0117647059   0 0 0 0 0.0862745098   0 0 0 0 0.160784314  0 0 0 0.11 0" type="matrix" in="shadowBlurOuter2" result="shadowMatrixOuter2" data-v-5ae4a997></feColorMatrix><feMerge data-v-5ae4a997><feMergeNode in="shadowMatrixOuter1" data-v-5ae4a997></feMergeNode><feMergeNode in="shadowMatrixOuter2" data-v-5ae4a997></feMergeNode></feMerge></filter></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-5ae4a997><g id="Artboard" transform="translate(-460.000000, -125.000000)" data-v-5ae4a997><g id="Group-4" transform="translate(412.000000, 129.000000)" data-v-5ae4a997><g id="Group-2" transform="translate(58.000000, 0.000000)" data-v-5ae4a997><circle id="Oval" fill="#3560FF" opacity="0.100000001" cx="42" cy="42" r="42" data-v-5ae4a997></circle><g id="Group" transform="translate(6.000000, 6.000000)" data-v-5ae4a997><g id="Oval" data-v-5ae4a997><use fill="black" fill-opacity="1" filter="url(#filter-2)" xlink:href="#path-1" data-v-5ae4a997></use><use fill="#FFFFFF" fill-rule="evenodd" xlink:href="#path-1" data-v-5ae4a997></use></g><g id="upload-cloud" transform="translate(21.818182, 24.000000)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-5ae4a997><polyline id="Path" stroke="#000000" points="19.6458087 17.3789847 14.3565525 12.0897285 9.06729634 17.3789847" data-v-5ae4a997></polyline><path d="M14.3565525,12.0897285 L14.3565525,24.1794569" id="Path" stroke="#3560FF" data-v-5ae4a997></path><path d="M25.6438239,20.7792208 C28.2965835,19.3021499 29.6312816,16.1761528 28.8860265,13.1856562 C28.1407715,10.1951596 25.5052337,8.10125672 22.4838689,8.09921935 L20.8179512,8.09921935 C19.7219904,3.76967373 16.1275086,0.577339516 11.7773112,0.0700384831 C7.42711383,-0.43726255 3.22057026,1.84535014 1.19724759,5.81113853 C-0.826075091,9.77692693 -0.247870665,14.6059952 2.6515151,17.9569414" id="Path" stroke="#3560FF" data-v-5ae4a997></path><polyline id="Path" stroke="#3560FF" points="19.6458087 17.3789847 14.3565525 12.0897285 9.06729634 17.3789847" data-v-5ae4a997></polyline></g></g></g></g></g></g>',2),I=[q],G=(0,i.Uk)(" Ajouter une image pour démarer la recherche "),R=w((()=>(0,i._)("p",{class:"separator",style:{"margin-top":"10px","margin-bottom":"10px"}},[(0,i._)("span",{style:{visibility:"hidden"}},".")],-1))),L=(0,i.Uk)((0,r.zw)("Choisir")),$=w((()=>(0,i._)("span",{style:{display:"inline-block",width:"5px"}},null,-1))),N=(0,i.Uk)((0,r.zw)("Arreter"));function E(e,t,a,n,s,o){const l=(0,i.up)("va-alert"),c=(0,i.up)("va-input"),u=(0,i.up)("va-progress-bar"),d=(0,i.up)("va-list-label"),h=(0,i.up)("va-avatar"),p=(0,i.up)("va-list-item-section"),f=(0,i.up)("va-list-item-label"),m=(0,i.up)("va-icon"),g=(0,i.up)("va-list-item"),v=(0,i.up)("va-list"),w=(0,i.up)("va-button");return(0,i.wg)(),(0,i.iD)("div",y,[x,(0,i._)("div",null,[(0,i._)("div",b,[s.searching?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",_,[(0,i._)("div",k,[(0,i._)("div",null,[(0,i.Wm)(l,{border:"top",class:"mb-4"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Recherche dans la base "+(0,r.zw)(s.subjectCount)+" sujets déja enregistré ",1)])),_:1})]),C,(0,i._)("div",O,[(0,i.Wm)(c,{min:1,max:200,type:"number",modelValue:s.concurrency,"onUpdate:modelValue":t[0]||(t[0]=e=>s.concurrency=e),label:"Nombre de tache en simultané (1-200)"},null,8,["modelValue"])]),F,(0,i._)("div",j,[(0,i.Wm)(c,{min:10,max:100,type:"number",modelValue:s.threshold,"onUpdate:modelValue":t[1]||(t[1]=e=>s.threshold=e),label:"Score minimum à matcher (10-100)"},null,8,["modelValue"])]),P,(0,i._)("div",S,[(0,i.Wm)(c,{min:1,max:100,type:"number",modelValue:s.maxResult,"onUpdate:modelValue":t[2]||(t[2]=e=>s.maxResult=e),label:"Nombre maximum de sujet à matcher  (1-100)"},null,8,["modelValue"])]),T])])),s.searching?((0,i.wg)(),(0,i.iD)("div",U,[(0,i._)("div",M,[(0,i.Wm)(u,{size:"medium",buffer:100,"model-value":o.searchPercent()},null,8,["model-value"])])])):(0,i.kq)("",!0),s.matches.length?((0,i.wg)(),(0,i.iD)("div",W,[(0,i.Wm)(v,{fit:""},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{style:{"text-align":"left","font-size":"25px"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" Concordances ("+(0,r.zw)(s.matches.length)+") ",1)])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.matches,((e,t)=>((0,i.wg)(),(0,i.j4)(g,{key:t},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{avatar:""},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i._)("img",{src:o.getSubjectPhoto(e)},null,8,B)])),_:2},1024)])),_:2},1024),(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,{style:{"text-align":"left"}},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(e.key.toUpperCase()),1)])),_:2},1024),(0,i.Wm)(f,{caption:"",style:{"font-weight":"bold","text-align":"left"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" score: "+(0,r.zw)(e.score.toFixed(2)),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(p,{icon:""},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{onClick:t=>o.openImage(o.getSubjectPhoto(e)),name:"remove_red_eye",color:"gray"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):(0,i.kq)("",!0),(0,i._)("input",D,null,512),(0,i._)("div",{onClick:t[4]||(t[4]=(...e)=>o.selectFolder&&o.selectFolder(...e))},[(0,i._)("div",V,[(0,i._)("figure",null,[s.searching?((0,i.wg)(),(0,i.iD)("img",{key:0,style:{"border-radius":"80px",border:"4px solid #e2e7f7",margin:"20px",width:"120px",height:"120px"},src:s.searchBlobUrl},null,8,z)):(0,i.kq)("",!0),s.searching?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("svg",A,I))]),G,R,(0,i.Wm)(w,{disabled:s.searching,color:"primary",style:{width:"140px"}},{default:(0,i.w5)((()=>[L])),_:1},8,["disabled"]),$,(0,i.Wm)(w,{onClick:t[3]||(t[3]=e=>o.stopSearch()),disabled:!s.searching,color:"primary",style:{width:"140px"}},{default:(0,i.w5)((()=>[N])),_:1},8,["disabled"])])])])])])}var Z=a(7387),H=a.n(Z),J=a(166),Y=a(7603);const Q=new Y.ZP("biometrex");async function K(){return await Q.subjects.count()}async function X(){await Q.subjects.clear(),console.log("delete existing")}async function ee(){return Q.table("subjects").toArray()}async function te(e,t){const a=await Q.subjects.where("key").equals(e).first();a?(console.log("save face for subject",t),await Q.subjects.update(a.id,{faceDescription:a.faceDescription.concat(t)})):console.warn("try to set face data to unexisted record")}async function ae(e,t,a){console.log("init for ",e,a);const n=await Q.subjects.where("key").equals(e).first(),i=t.map((e=>new Blob([e],{type:e.type})));n&&"override"!==a?(console.log("exist, strategy",a,n),await Q.subjects.update(n.id,{personFiles:n.personFiles.concat(i)})):(n&&(console.log("exist, strategy",a,n),await Q.subjects.where("key").equals(e).delete(),console.log("delete existing")),console.log("no exist, strategy"),await Q.subjects.add({key:e,personFiles:i,faceDescription:[]}),console.log("added"))}Q.version(1).stores({subjects:"++id, key"});const ne=a(3233),ie="/models";var re={name:"SearchAttachmentComponent",data(){return{$directory:"",eventInit:!1,searching:!1,searchBlobUrl:null,concurrency:1,searchProgress:0,willTrainCount:0,threshold:80,maxResult:10,subjectCount:"",matches:[],queue:null}},components:{},setup(){return{}},mounted(){this.iniFaceJs(),this.countSubject()},methods:{async stopSearch(){console.log("here"),this.queue?.stop(),await this.sleep(100),this.reset()},searchPercent(){return 100*this.searchProgress/this.willTrainCount},async reset(){this.searching=!1,this.matches=[],this.queue=null,this.searchProgress=0,this.willTrainCount=0,this.countSubject()},openImage(e){window.open(e,"_blank","toolbar=1, scrollbars=1, resizable=1, width=1015, height=800")},async sleep(e){return new Promise((t=>setTimeout(t,e)))},async countSubject(){this.subjectCount=await K()},async iniFaceJs(){await J.dd(ie),await J.W6(ie),await J.Qk(ie)},selectFolder(){if(this.searching)return;const e=H()(this.$refs.input);this.eventInit||(this.listenChangeEvent(e),this.eventInit=!0),e.click()},listenChangeEvent(e){e.on("change",(()=>{const t=e[0].files[0];console.log(t),this.willTrainCount=this.subjectCount,console.log(this.willTrainCount,"willTrainCount"),this.searchFace(t)}))},finishSearch(){this.$vaToast.init("Recherche terminé"),this.queue?.stop(),console.log(this.matches)},getSubjectPhoto(e){try{return URL.createObjectURL(e.personFiles[0])}catch(t){console.log()}},async matchPerson(e,t,a){try{for(let a of e.faceDescription){let n=J.WI(a.descriptor,t.descriptor);const i=100*(1-n);if(i>=this.threshold){e.score=i,this.matches.push(e);break}}}catch(n){console.log(n)}this.searchProgress++,a(),this.matches.length>=this.maxResult&&this.finishSearch()},async searchFace(e){this.queue=new ne({autoStart:!0,concurrency:this.concurrency}),this.searchBlobUrl=URL.createObjectURL(new Blob([e],{type:e.type})),this.searching=!0,this.$vaToast.init("Recherche sur le point de démarrer"),console.log("start searching");const t=await J.dV(e),a=await J.bd(t).withFaceLandmarks().withFaceDescriptor(),n=[],i=await ee();for(let r of i)n.push(this.queue.pushTask((e=>{this.matchPerson(r,a,e)})));await Promise.all(n),this.finishSearch()}},computed:{}};const se=(0,d.Z)(re,[["render",E],["__scopeId","data-v-5ae4a997"]]);var oe=se,le={name:"SearchPage",components:{SearchAttachmentComponent:oe}};const ce=(0,d.Z)(le,[["render",v]]);var ue=ce;const de=(0,i._)("img",{style:{width:"100px"},src:m},null,-1);function he(e,t,a,n,r,s){const o=(0,i.up)("TrainAttachmentComponent");return(0,i.wg)(),(0,i.iD)(i.HY,null,[de,(0,i.Wm)(o)],64)}const pe=e=>((0,i.dD)("data-v-8f348714"),e=e(),(0,i.Cn)(),e),fe={class:"container"},me=pe((()=>(0,i._)("div",{class:"hello"},"BioMetrex",-1))),ge={style:{margin:"10px",_background:"#f9f9f9"},class:"dropzone-container"},ve={key:0,style:{margin:"50px"}},we={class:"components"},ye=pe((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),xe={class:"component",style:{}},be=pe((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),_e={class:"component",style:{}},ke=pe((()=>(0,i._)("div",{style:{height:"25px"}},null,-1))),Ce={class:"component",style:{}},Oe={key:1,style:{margin:"50px"}},Fe={class:"components"},je={style:{display:"none"},ref:"input",multiple:"",directory:"",webkitdirectory:"",moxdirectory:"",type:"file"},Pe={class:"file-selector"},Se=pe((()=>(0,i._)("figure",null,[(0,i._)("svg",{width:"104px",height:"104px",viewBox:"0 0 104 104",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[(0,i._)("defs",null,[(0,i._)("circle",{id:"path-1",cx:"36",cy:"36",r:"36"}),(0,i._)("filter",{x:"-37.5%",y:"-29.2%",width:"175.0%",height:"175.0%",filterUnits:"objectBoundingBox",id:"filter-2"},[(0,i._)("feOffset",{dx:"0",dy:"6",in:"SourceAlpha",result:"shadowOffsetOuter1"}),(0,i._)("feGaussianBlur",{stdDeviation:"8",in:"shadowOffsetOuter1",result:"shadowBlurOuter1"}),(0,i._)("feColorMatrix",{values:"0 0 0 0 0.0117647059   0 0 0 0 0.0862745098   0 0 0 0 0.160784314  0 0 0 0.08 0",type:"matrix",in:"shadowBlurOuter1",result:"shadowMatrixOuter1"}),(0,i._)("feOffset",{dx:"0",dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter2"}),(0,i._)("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter2",result:"shadowBlurOuter2"}),(0,i._)("feColorMatrix",{values:"0 0 0 0 0.0117647059   0 0 0 0 0.0862745098   0 0 0 0 0.160784314  0 0 0 0.11 0",type:"matrix",in:"shadowBlurOuter2",result:"shadowMatrixOuter2"}),(0,i._)("feMerge",null,[(0,i._)("feMergeNode",{in:"shadowMatrixOuter1"}),(0,i._)("feMergeNode",{in:"shadowMatrixOuter2"})])])]),(0,i._)("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[(0,i._)("g",{id:"Artboard",transform:"translate(-460.000000, -125.000000)"},[(0,i._)("g",{id:"Group-4",transform:"translate(412.000000, 129.000000)"},[(0,i._)("g",{id:"Group-2",transform:"translate(58.000000, 0.000000)"},[(0,i._)("circle",{id:"Oval",fill:"#3560FF",opacity:"0.100000001",cx:"42",cy:"42",r:"42"}),(0,i._)("g",{id:"Group",transform:"translate(6.000000, 6.000000)"},[(0,i._)("g",{id:"Oval"},[(0,i._)("use",{fill:"black","fill-opacity":"1",filter:"url(#filter-2)","xlink:href":"#path-1"}),(0,i._)("use",{fill:"#FFFFFF","fill-rule":"evenodd","xlink:href":"#path-1"})]),(0,i._)("g",{id:"upload-cloud",transform:"translate(21.818182, 24.000000)","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[(0,i._)("polyline",{id:"Path",stroke:"#000000",points:"19.6458087 17.3789847 14.3565525 12.0897285 9.06729634 17.3789847"}),(0,i._)("path",{d:"M14.3565525,12.0897285 L14.3565525,24.1794569",id:"Path",stroke:"#3560FF"}),(0,i._)("path",{d:"M25.6438239,20.7792208 C28.2965835,19.3021499 29.6312816,16.1761528 28.8860265,13.1856562 C28.1407715,10.1951596 25.5052337,8.10125672 22.4838689,8.09921935 L20.8179512,8.09921935 C19.7219904,3.76967373 16.1275086,0.577339516 11.7773112,0.0700384831 C7.42711383,-0.43726255 3.22057026,1.84535014 1.19724759,5.81113853 C-0.826075091,9.77692693 -0.247870665,14.6059952 2.6515151,17.9569414",id:"Path",stroke:"#3560FF"}),(0,i._)("polyline",{id:"Path",stroke:"#3560FF",points:"19.6458087 17.3789847 14.3565525 12.0897285 9.06729634 17.3789847"})])])])])])])])],-1))),Te=(0,i.Uk)(" Ajouter un dossier pour entrainer les modèles "),Ue=pe((()=>(0,i._)("p",{class:"separator",style:{"margin-top":"10px","margin-bottom":"10px"}},[(0,i._)("span",{style:{visibility:"hidden"}},".")],-1))),Me=(0,i.Uk)((0,r.zw)("Choisir"));function We(e,t,a,n,s,o){const l=(0,i.up)("va-alert"),c=(0,i.up)("va-input"),u=(0,i.up)("va-select"),d=(0,i.up)("va-progress-bar"),h=(0,i.up)("va-button");return(0,i.wg)(),(0,i.iD)("div",fe,[me,(0,i._)("div",null,[(0,i._)("div",ge,[s.traning?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",ve,[(0,i._)("div",we,[(0,i._)("div",null,[(0,i.Wm)(l,{border:"top",class:"mb-4"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(s.subjectCount)+" Sujets déja enregistré ",1)])),_:1})]),ye,(0,i._)("div",xe,[(0,i.Wm)(c,{min:1,max:200,type:"number",modelValue:s.concurrency,"onUpdate:modelValue":t[0]||(t[0]=e=>s.concurrency=e),label:"Nombre de tache en simultané (1-200)"},null,8,["modelValue"])]),be,(0,i._)("div",_e,[(0,i.Wm)(c,{min:1,max:200,type:"number",modelValue:s.idSize,"onUpdate:modelValue":t[1]||(t[1]=e=>s.idSize=e),label:"Longueur des identifiants (1-200)"},null,8,["modelValue"])]),ke,(0,i._)("div",Ce,[(0,i.Wm)(u,{modelValue:s.strategySelectValue,"onUpdate:modelValue":t[2]||(t[2]=e=>s.strategySelectValue=e),options:s.strategyOptions,label:"Stratégie des données existantes"},null,8,["modelValue","options"])])])])),s.traning?((0,i.wg)(),(0,i.iD)("div",Oe,[(0,i._)("div",Fe,[(0,i.Wm)(d,{size:"medium",buffer:100,"model-value":o.trainPercent()},null,8,["model-value"])])])):(0,i.kq)("",!0),(0,i._)("input",je,null,512),(0,i._)("div",{onClick:t[3]||(t[3]=(...e)=>o.selectFolder&&o.selectFolder(...e))},[(0,i._)("div",Pe,[Se,Te,Ue,(0,i.Wm)(h,{color:"primary",style:{width:"140px"}},{default:(0,i.w5)((()=>[Me])),_:1})])])])])])}const Be=a(3233),De="/models";var Ve={name:"TrainAttachmentComponent",data(){return{$directory:"",eventInit:!1,traning:!1,concurrency:1,trainProgress:0,willTrainCount:0,idSize:36,subjectCount:"",strategySelectValue:{text:"Écraser",value:"override"},strategyOptions:[{text:"Écraser",value:"override"},{text:"Fusionner",value:"merge"}]}},components:{},setup(){return{}},mounted(){this.iniFaceJs(),this.countSubject()},methods:{trainPercent(){return 100*this.trainProgress/this.willTrainCount},async reset(){this.traning=!1,this.trainProgress=0,this.willTrainCount=0,this.countSubject()},async sleep(e){return new Promise((t=>setTimeout(t,e)))},async countSubject(){this.subjectCount=await K()},async iniFaceJs(){await J.dd(De),await J.W6(De),await J.Qk(De)},selectFolder(){if(this.traning)return this.$vaToast.init("Une tache est deja en cours");const e=H()(this.$refs.input);this.eventInit||(this.listenChangeEvent(e),this.eventInit=!0),e.click()},groupFilePerId(e){const t={};for(let a of e){const e=a.name.substring(0,this.idSize);t[e]=t[e]||[],t[e].push(a)}return t},listenChangeEvent(e){e.on("change",(()=>{const t=e[0].files;this.willTrainCount=t.length,console.log(this.willTrainCount,"willTrainCount");const a=this.groupFilePerId(t);this.trainData(a)}))},async trainSingleFace(e,t,a){try{const n=await J.dV(t),i=await J.bd(n).withFaceLandmarks().withFaceDescriptor();if(!i)return console.log(`no faces detected for in image ${t.name}`),this.trainProgress++,void a();const r=i;return console.log(this.trainProgress,this.willTrainCount),te(e,r),this.trainProgress++,a(),r}catch(n){console.log(n),a()}},async trainData(e){"override"===this.strategySelectValue.value&&await X();const t=new Be({autoStart:!0,concurrency:this.concurrency});this.traning=!0,console.log("start training"),this.$vaToast.init("Entrainement sur le point de démarrer");const a=[];for(let i of Object.keys(e))a.push(t.pushTask((async t=>{try{const n=e[i];await ae(i,n,this.strategySelectValue.value);for(let e of n)a.push(this.trainSingleFace(i,e,t))}catch(n){console.log(n),t()}})));const n=(await Promise.all(a)).filter((e=>e));this.traning=!1,t.stop(),this.reset(),console.log(n,"resultsTrain"),this.$vaToast.init("Tache terminée")}},computed:{}};const ze=(0,d.Z)(Ve,[["render",We],["__scopeId","data-v-8f348714"]]);var Ae=ze,qe={name:"TrainPage",components:{TrainAttachmentComponent:Ae}};const Ie=(0,d.Z)(qe,[["render",he]]);var Ge=Ie;const Re=[{path:"/",name:"SearchPage",component:ue},{path:"/train",name:"TrainPage",component:Ge}],Le=(0,f.p7)({history:(0,f.PO)(),routes:Re});var $e=Le,Ne=a(4954);a(2095);(0,n.ri)(p).use($e).use((0,Ne.C)()).mount("#app")},4902:function(){},522:function(){},753:function(){}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,r){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],i=e[u][1],r=e[u][2];for(var o=!0,l=0;l<n.length;l++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(o=!1,r<s&&(s=r));if(o){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,i,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,r,s=n[0],o=n[1],l=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var u=l(a)}for(t&&t(n);c<s.length;c++)r=s[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},n=self["webpackChunkbiometrex"]=self["webpackChunkbiometrex"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(1508)}));n=a.O(n)})();
//# sourceMappingURL=app.07f97db8.js.map